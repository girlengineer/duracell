<section class="comparison-table-module">
  <div *ngIf="isProcessing" class="jamp jamp-css">
    <span class="img loading"></span>
    <span class="message">{{loadingMessage}}</span>
  </div>
  <div *ngIf="!isProcessing && !hasData" class="jamp">
    <h4 style="color: #D60000"><strong>{{emptyMessage}}</strong></h4>
  </div>
  <div *ngIf="!isProcessing && hasData" class="container-fluid">
    <div class="row">
      <div class="col-xs-12">
        <table [attr.role]="!isDesktopWidth ? 'presentation' : ''"
               [ngClass]="{table: true, 'comparison-table': true, 'mode-desktop': isDesktopWidth, 'mode-mobile': !isDesktopWidth}">
          <caption *ngIf="caption !== undefined" [attr.aria-live]="'polite'" [attr.aria-atomic]="false">
            <h1 class="header-3">{{caption}}</h1>
            <div class="visible-xs">
              <button data-id="0" class="toggle-accordion-table btn-link" (click)="onAllItemButtonClick($event)">
                <span>{{allItemExpanded ? 'Collapse All Sections' : 'Expand All Sections'}}</span>
              </button>
              <!-- data-accordion-state="collapse" data-toggled-copy="Collapse All Sections"-->
            </div>
          </caption>
          <thead [attr.aria-hidden]="isDesktopWidth ? false: true">
            <tr>
              <th>{{options.list.listHeader}}</th>
              <th *ngFor="let header of options.list.items" [attr.scope]="'col'">
                <a *ngIf="header.hasOwnProperty('header')" href="#" class="chevron-link bold">
                  <strong>{{header.header}}</strong>
                </a>
              </th>
            </tr>
          </thead>
          <tbody [attr.role]="'tablist'">
            <template ngFor [ngForOf]="options.displayedKeys" let-item>
              <tr [ngClass]="{'for-mobile': true, 'is-expanded': item.expanded === true}"
                  role="presentation" [attr.data-toggle]="item.expanded === true ? 'expanded' : 'collapse'"
                  (click)="onItemClick(item)">
                <th scope="row" role="presentation">
                  <div class="icon-svg svg-arrow-dropdown-down comparison-table-arrow-down"></div>
                  <span id="comparisonTableHeader-{{item.key}}" class="category-title" tabindex="0"
                        role="tab" aria-posinset="1"
                        aria-setsize="5"  aria-expanded="true"
                        [attr.aria-controls]="'comparisonTablePanel-' + item.key"
                        aria-selected="true" data-title="Select to hide">{{item.text}}</span>
                </th>
              </tr>
              <tr class="table-row"
                  [attr.aria-labelledby]="'comparisonTableHeader-' + item.key" role="tabpanel"
                  id="comparisonTablePanel-{{item.key}}"
                  [attr.aria-hidden]="!isDesktopWidth && item.expanded === false">
                <th scope="row">{{item.text}}</th>
                <td *ngFor="let listItem of options.list.items">
                  <a href="#" class="chevron-link bold">{{listItem.header}}</a>
                  <span *ngIf="listItem[item.key] !== undefined" [ngSwitch]="listItem[item.key].type"
                        class="row-content-container">
                    <template [ngSwitchCase]="'number'">
                      {{listItem[item.key].value}}
                    </template>
                    <template [ngSwitchCase]="'boolean'">
                      <template [ngIf]="listItem[item.key].value === true">
                        <span class="svg-icon table-check-mark">âœ“
                        <span class="sr-only">{{listItem[item.key].value}}</span>
                      </span>
                      </template>
                      <template [ngIf]="listItem[item.key].value !== true">
                        _ <span class="sr-only">{{listItem[item.key].value}}</span>
                      </template>
                    </template>
                    <template [ngIf]="listItem[item.key].hasOwnProperty('secondaryDescription')">
                      <br/> {{listItem[item.key].secondaryDescription}}
                    </template>
                  </span>
                </td>
              </tr>
            </template>
            <!--<citi-comparison-table-row *ngFor="let item of options.displayedKeys" [data]="item"-->
                                       <!--[items]="options.list.items">-->
            <!--</citi-comparison-table-row>-->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
